<!DOCTYPE html><html lang="en-gb" prefix="og: http://ogp.me/ns#"><head>
<base href="https://www.secnix.com" />
<meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, user-scalable=1, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0"><meta name="theme-color" content="#FEAA5B"><title>A 12-factor App in OpenShift – Deep Dive</title><meta name="description" content="A 12-factor App in OpenShift – Deep Dive
The 12-factor app methodology has an incredible grip on the software industry. It is the realisation of fantastic portability across cloud-based resources and application artifacts. Not only has the entire stack become easily implemented in code, it is declarative and inc ..." /><meta name="title" content="A 12-factor App in OpenShift – Deep Dive - Secnix Systems" /><link rel="canonical" href="https://www.secnix.com/engineering-titbits/12-factor-app-in-openshift/" /><meta property="og:locale" content="en_GB" /><meta property="og:type" content="article" /><meta property="og:title" content="A 12-factor App in OpenShift – Deep Dive - Secnix Systems" /><meta property="og:description" content="A 12-factor App in OpenShift – Deep Dive The 12-factor app methodology has an incredible grip on the software industry. It is the realisation of fantastic portability across cloud-based resources and application artifacts. Not only &hellip;" /><meta property="og:url" content="https://www.secnix.com/engineering-titbits/12-factor-app-in-openshift/" /><meta property="og:site_name" content="Secnix Systems" /><meta property="article:tag" content="container-native" /><meta property="article:tag" content="docker" /><meta property="article:tag" content="kubernetes" /><meta property="article:tag" content="openshift" /><meta property="article:tag" content="spring" /><meta property="article:section" content="Engineering Titbits" /><meta property="article:published_time" content="2018-03-27T13:43:02+00:00" /><meta property="article:modified_time" content="2018-03-27T23:49:59+00:00" /><meta property="og:updated_time" content="2018-03-27T23:49:59+00:00" /><meta property="og:image" content="https://www.secnix.com/wp-content/uploads/2018/03/process-1.png" /><meta property="og:image:secure_url" content="https://www.secnix.com/wp-content/uploads/2018/03/process-1.png" /><meta property="og:image:width" content="1344" /><meta property="og:image:height" content="645" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:description" content="A 12-factor App in OpenShift – Deep Dive The 12-factor app methodology has an incredible grip on the software industry. It is the realisation of fantastic portability across cloud-based resources and application artifacts. Not only [&hellip;]" /><meta name="twitter:title" content="A 12-factor App in OpenShift – Deep Dive - Secnix Systems" /><meta name="twitter:image" content="https://www.secnix.com/wp-content/uploads/2018/03/process-1.png" /><link rel="preload" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/font-awesome-4.7.0/css/font-awesome.min.css" as="style" media="all" onload="this.onload=null;this.rel='stylesheet'" /><noscript><link rel="stylesheet" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/font-awesome-4.7.0/css/font-awesome.min.css" media="all" /></noscript><!--[if IE]><link rel="stylesheet" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/font-awesome-4.7.0/css/font-awesome.min.css" media="all" /><![endif]--><link rel='stylesheet' id='fvm-header-0-css'  href='https://www.secnix.com/wp-content/uploads/fvm/out/header-d252331d-1547682011.min.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-min_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/bootstrap/css/bootstrap.min.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-reboot_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/bootstrap/css/bootstrap-reboot.min.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-grid_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/bootstrap/css/bootstrap-grid.min.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='fvm-header-4-css'  href='https://www.secnix.com/wp-content/uploads/fvm/out/header-1c9611c1-1547682011.min.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='dropdown_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/dropdown/css/style.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='theme_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/theme/css/style.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='mbr_additional_css-css'  href='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/mobirise/css/mbr-additional.css?ver=1550314351' type='text/css' media='all' /><link rel='stylesheet' id='fvm-header-8-css'  href='https://www.secnix.com/wp-content/uploads/fvm/out/header-49d30d75-1547682011.min.css?ver=1550314351' type='text/css' media='all' /> <script type='text/javascript' src='https://www.secnix.com/wp-content/uploads/fvm/out/header-cb050ccd-1547682011.min.js'></script><link rel='https://api.w.org/' href='https://www.secnix.com/wp-json/' /><meta name="author" content="Secnix Systems"><meta name="copyright" content="Copyright 2018 Secnix Systems Ltd - All rights Reserved."><meta name="distribution" content="Global"><meta name="language" content="en-GB"><meta name="revisit-after" content="3"> <script type="application/ld+json">{"@context":"http:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.secnix.com\/engineering-titbits\/12-factor-app-in-openshift\/"},"url":"https:\/\/www.secnix.com\/engineering-titbits\/12-factor-app-in-openshift\/","headline":"A 12-factor App in OpenShift – Deep Dive","datePublished":"2018-03-27T14:43:02+00:00","dateModified":"2018-03-28T00:49:59+00:00","publisher":{"@type":"Organization","@id":"https:\/\/www.secnix.com\/#organization","name":"Secnix Systems Limited","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/www.secnix.com\/wp-content\/uploads\/2018\/03\/process-1.png","width":1344,"height":645},"articleSection":"Engineering Titbits","keywords":"container-native, docker, kubernetes, openshift, spring","description":"A 12-factor App in OpenShift – Deep Dive The 12-factor app methodology has an incredible grip on the software industry. It is the realisation of fantastic portability across cloud-based resources and application artifacts. Not only has the entire stack become easily implemented in code, it is declarative and incredibly","author":{"@type":"Person","name":"Justin Cook","url":"https:\/\/www.secnix.com\/author\/jhcook\/","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/bf4ccecac1b8f319edd0ce2094d9a378?s=96&d=mm&r=g","height":96,"width":96}}}</script> <style>#cookie-notice { background-color: rgba(0,0,0,0.75) !important; //border-radius: 25px; bottom: 104px; //min-width: 82% !important; //margin: 0 9% 0 9%; box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23); } #cn-more-info { color: #a2a2a2 !important; } #cn-accept-cookie { }</style> <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-116492935-1', 'auto');
  ga('send', 'pageview');</script> <link rel="apple-touch-icon" sizes="180x180" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="194x194" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/favicon-194x194.png"><link rel="icon" type="image/png" sizes="192x192" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/android-chrome-192x192.png"><link rel="icon" type="image/png" sizes="16x16" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/favicon-16x16.png"><link rel="manifest" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/manifest.json"><link rel="mask-icon" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/favicon.ico"><meta name="msapplication-TileColor" content="#feaa5b"><meta name="msapplication-TileImage" content="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/mstile-144x144.png"><meta name="msapplication-config" content="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/favicons/browserconfig.xml"><style>iframe{ position: relative; width: 100%; border: 0px; height: 600px; margin: 0; overflow: hidden; }</style></head><body><section class="menu cid-qCG9AmiObi" once="menu" id="menu1-t" data-rv-view="2609"> <nav class="navbar navbar-dropdown beta-menu align-items-center navbar-fixed-top navbar-toggleable-sm bg-color transparent"><div class="menu-bottom"><div class="menu-logo"><div class="navbar-brand"> <span class="navbar-logo"> <a href="https://www.secnix.com"> <img src="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/images/secnix-new.svg" alt="Secnix" title="Secnix" media-simple="true" style="height: 3.8rem;"> </a> </span></div> <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="hamburger"> <span></span> <span></span> <span></span> <span></span></div> </button></div><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav nav-dropdown js-float-line" data-app-modern-menu="true"><li class="nav-item dropdown"> <a class="nav-link link mbr-white dropdown-toggle display-4" href="https://secnix.com" data-toggle="dropdown-submenu" aria-expanded="false"> ABOUT US</a><div class="dropdown-menu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#mission-statement">Mission Statement</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#the-company">The Company</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#our-partners">Our Partners</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#why-secnix">Why Secnix?</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/contact">Contact</a></div></li><li class="nav-item dropdown"> <a class="nav-link link mbr-white dropdown-toggle display-4" href="https://secnix.com" data-toggle="dropdown-submenu" aria-expanded="false"> BUSINESS AREAS</a><div class="dropdown-menu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#services">Overview</a><div class="dropdown"> <a class="mbr-white dropdown-item dropdown-toggle display-4" href="https://www.secnix.com/web-services/" data-toggle="dropdown-submenu" aria-expanded="false">Creative Web</a><div class="dropdown-menu dropdown-submenu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/web-design/">Web Design</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/web-development/">Web Development</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/responsive-websites/">Responsive Websites</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/ecommerce-stores/">E-commerce Stores</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/content-design/">Content, UI and UX Design</a></div></div><div class="dropdown"> <a class="mbr-white dropdown-item dropdown-toggle display-4" href="https://www.secnix.com/marketing-services/" data-toggle="dropdown-submenu" aria-expanded="false">Digital Marketing</a><div class="dropdown-menu dropdown-submenu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/seo/">SEO and SEM</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/campaigns/">Email &amp; Ad Campaigns</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/social-media/">Social Media</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/branding/">Logo and Branding</a></div></div><div class="dropdown"> <a class="mbr-white dropdown-item dropdown-toggle display-4" href="https://www.secnix.com/systems-services/" data-toggle="dropdown-submenu" aria-expanded="false">Resilient Systems</a><div class="dropdown-menu dropdown-submenu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/infrastructure/">Infrastructure</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/distributed-systems/">Distributed Systems</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/maintenance/">Maintenance</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/automation/">Automation</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/cloud-native/">Cloud Native</a></div></div></div></li><li class="nav-item dropdown"> <a class="nav-link link mbr-white dropdown-toggle display-4" href="https://secnix.com" aria-expanded="false" data-toggle="dropdown-submenu"> PACKAGES &amp; SUPPORT</a><div class="dropdown-menu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com#packages" aria-expanded="false">Overview</a></div></li><li class="nav-item dropdown"> <a class="nav-link link mbr-white dropdown-toggle display-4" href="https://secnix.com" aria-expanded="false" data-toggle="dropdown-submenu"> NEWS &amp; EVENTS</a><div class="dropdown-menu"> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/#engeering-titbits" aria-expanded="false">Engineering Titbits</a> <a class="mbr-white dropdown-item display-4" href="https://www.secnix.com/blog/" aria-expanded="false">Blog</a></div></li><div class="media-container-column navbar-buttons mbr-section-btn"> <a class="btn btn-md btn-bgr btn-secondary display-5 link d-lg-none d-xl-block" href="https://www.secnix.com/contact/">CONTACT US</a></div></ul></div></div> </nav> </section><section class="header4 cid-qG4g1u7wK3 mbr-parallax-background" id="header4-19" data-rv-view="2613"><div class="mbr-overlay" style="opacity: 0.85;"></div><div class="container align-center"><div class="row justify-content-center"><div class="media-container-column mbr-white col-md-10 offset-md-1"><h1 class="mbr-section-title pb-3 mbr-fonts-style display-1 blog-title"><strong>A 12-factor App in OpenShift – Deep Dive</strong></h1></div></div></div> </section><section class="features9 cid-qG67iF0qRYe" id="features9-26" data-rv-view="2654"><div class="container"><div class="media-container-row"><div class="col-lg-9 blog-img"><ol class="breadcrumb fixed-shadow"><li class="breadcrumb-item"><a href="https://www.secnix.com">Home</a></li><li class="breadcrumb-item"><a href="https://www.secnix.com/blog/">Blog</a></li><li class="breadcrumb-item"><a href="https://www.secnix.com/category/engineering-titbits/" title="Engineering Titbits">Engineering Titbits</a></li><li class="breadcrumb-item active">A 12-factor App in OpenShift – Deep Dive</li></ol><br><h2 class="mbr-section-subtitle mbr-fonts-style display-1">A 12-factor App in OpenShift – Deep Dive</h2> 27/03/2018, by Justin Cook</a><br><br> <img width="1344" height="645" src="https://www.secnix.com/wp-content/uploads/2018/03/process-1.png" class="attachment-custom-size size-custom-size wp-post-image" alt="" srcset="https://www.secnix.com/wp-content/uploads/2018/03/process-1.png 1344w, https://www.secnix.com/wp-content/uploads/2018/03/process-1-300x144.png 300w, https://www.secnix.com/wp-content/uploads/2018/03/process-1-768x369.png 768w, https://www.secnix.com/wp-content/uploads/2018/03/process-1-1024x491.png 1024w" sizes="(max-width: 1344px) 100vw, 1344px" /><br><br><style type="text/css">.fb-comments,.fb-comments span,.fb-comments span iframe[style]{min-width:100%!important;width:100%!important}</style><div id="fb-root"></div><h3>A 12-factor App in OpenShift – Deep Dive</h3><p>The <a href="https://12factor.net/" target="_blank" rel="noopener">12-factor app methodology</a> has an incredible grip on the software industry. It is the realisation of fantastic portability across cloud-based resources and application artifacts. Not only has the entire stack become easily implemented in code, it is declarative and incredibly robust when configured with idempotent management systems. It’s mesmerising that once upon a time in a daily grind not far gone, operations personnel had to work alongside developers and hardware personnel to provision and configure kit to get started. Instead, we take a look at developing and deploying an application that enables debugging and interfacing with multiple cloud providers which support the <a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a> ecosystem – in our case <a href="https://www.openshift.com/" target="_blank" rel="noopener">OpenShift</a>.</p><p>&nbsp;</p><h3>Follow Along</h3><p>If you’d like to follow along, you need a workstation capable of running your favourite IDE, <a href="https://java.com/" target="_blank" rel="noopener">Java</a>, and a virtual machine. Here we use <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener">VirtualBox</a>. In order to follow along, you can use <a href="https://docs.openshift.org/latest/minishift/getting-started/installing.html" target="_blank" rel="noopener">Minishift</a> or the official <a href="https://developers.redhat.com/products/cdk/download/" target="_blank" rel="noopener">CDK</a> released by <a href="https://www.redhat.com/" target="_blank" rel="noopener">Red Hat</a>. In order to use the latter, you will need a <a href="https://developers.redhat.com/products/rhel/download/" target="_blank" rel="noopener">Red Hat Developer Subscription</a>. Here, we use the CDK.  To build the software, we use <a href="https://maven.apache.org/" target="_blank" rel="noopener">Apache Maven</a>. Finally, we use <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a> to fetch source code from repositories.</p><p>Many web applications are written in Java and delivered as a <em>WAR</em>, or web application resource, file. Many of these are developed using the <a href="https://spring.io/" target="_blank" rel="noopener">Spring Framework</a>. Given this is a formidable representation of web application estates, we’ll show just how much convergence the toolchain has experienced.</p><p>&nbsp;</p><h3>Setup Local Environment</h3><p>To get started, we begin the same way everyone should, and that’s with “Hello World” – it’s never let anyone down. To make things easy, the Spring Boot project provides an example in the <a href="https://github.com/spring-projects/spring-boot" target="_blank" rel="noopener">Spring Boot GitHub repository</a>. We start by cloning this repository.</p><pre>&gt;&gt;&gt; (03:40 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift)
$ git clone https://github.com/spring-projects/spring-boot.git
Cloning into 'spring-boot'...
remote: Counting objects: 348794, done.
remote: Compressing objects: 100% (73/73), done.remote: Total 348794 (delta 48), reused 74 (delta 39), pack-reused 348679
Receiving objects: 100% (348794/348794), 72.44 MiB | 3.57 MiB/s, done.
Resolving deltas: 100% (144733/144733), done.</pre><p>Now we have the entire source for Spring Boot. There are a plethora of examples in the <em>spring-boot-samples</em> directory. As previously mentioned, we will change directories to the <em>spring-boot-sample-war</em> subdirectory and apply the following patch to the pom.xml file:</p><pre>diff --git a/spring-boot-samples/spring-boot-sample-war/pom.xml b/spring-boot-samples/spring-boot-sample-war/pom.xml
index 65276f61ce..22b2fda653 100644
--- a/spring-boot-samples/spring-boot-sample-war/pom.xml
+++ b/spring-boot-samples/spring-boot-sample-war/pom.xml
@@ -5,8 +5,8 @@
	&lt;parent&gt;
		&lt;!-- Your own application should inherit from spring-boot-starter-parent --&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
-               &lt;artifactId&gt;spring-boot-samples&lt;/artifactId&gt;
-               &lt;version&gt;${revision}&lt;/version&gt;
+               &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
+               &lt;version&gt;2.0.0.RELEASE&lt;/version&gt;
	&lt;/parent&gt;
	&lt;artifactId&gt;spring-boot-sample-war&lt;/artifactId&gt;
	&lt;packaging&gt;war&lt;/packaging&gt;</pre><p>Now, we are able to build a <em>WAR</em> file using Maven. In the same directory, we use the Maven goal to build the package.</p><pre>&gt;&gt;&gt; (06:48 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ mvn -U clean package
[INFO] Scanning for projects...
...
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO]
[INFO]
[INFO] --- maven-war-plugin:3.1.0:war (default-war) @ spring-boot-sample-war ---
[INFO] Packaging webapp
[INFO] Assembling webapp [spring-boot-sample-war] in [/Users/jcook/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war/target/spring-boot-sample-war-2.0.0.RELEASE]
[INFO] Processing war project
[INFO] Copying webapp resources [/Users/jcook/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war/src/main/webapp]
[INFO] Webapp assembled in [104 msecs]
[INFO] Building war: /Users/jcook/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war/target/spring-boot-sample-war-2.0.0.RELEASE.war
[INFO]
[INFO] --- spring-boot-maven-plugin:2.0.0.RELEASE:repackage (default) @ spring-boot-sample-war ---
[INFO] ---------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ---------------------------------------------------------------------
[INFO] Total time: 6.643 s
[INFO] Finished at: 2018-03-25T18:51:45+01:00
[INFO] Final Memory: 36M/311M
[INFO] ---------------------------------------------------------------------
</pre><p>If we inspect the <em>target</em> subdirectory, we should see – amongst other things – the <em>WAR</em> file. In this case it is <em>spring-boot-sample-war-2.0.0.RELEASE.war.</em> This is nice, but let’s see it running, shall we? There are several ways to do that. But, our project will be running on <em>OpenShift</em>, which is <em>Kubernetes</em>. Thankfully, the <em>OpenShift</em> community make <em>Minishift</em> and Red Hat make the <em>CDK</em> available. Result! Our life as a developer is much easier.</p><p>&nbsp;</p><h3>Setup “The Cloud”</h3><pre>&gt;&gt;&gt; (06:50 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ minishift start-- Starting profile 'minishift'
...
The server is accessible via web console at:
https://192.168.99.100:8443
You are logged in as:
User:     developer
Password: &lt;any value&gt;
To login as administrator:
oc login -u system:admin
-- Waiting for persistent volumes to be created ... OK
-- Applying addon 'anyuid':.
Add-on 'anyuid' changed the default security context constraints to allow pods to run as any user.
Per default OpenShift runs containers using an arbitrarily assigned user ID.
Refer to https://docs.openshift.org/latest/architecture/additional_concepts/authorization.html#security-context-constraints and
https://docs.openshift.org/latest/creating_images/guidelines.html#openshift-origin-specific-guidelines for more information.
-- Applying addon 'eap':...
-- Applying addon 'fuse':...............
-- Applying addon 'admin-user':..
</pre><p>Ok, this is exciting! We have a <em>WAR</em> file and an <em>OpenShift</em> instance. At this point, we need to configure our project in <em>OpenShift</em>. The <em>CDK</em> has created a project for us. So, we can move on and create all the necessary objects.</p><pre>
>>> (07:15 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc project
Using project "myproject" on server "https://192.168.99.101:8443".</pre><p>&nbsp;</p><h3>Uber Convergence</h3><p>Things are looking great. But, we want to work in our well-known development environment on our own machine, make changes, create artifacts, and see it work at our convenience. After we are confident our code meets requirements, we can commit and push to origin then let a CI/CD pipeline take it from there. In order to expedite delivery of code, <em>OpenShift</em> provides binary builds. This simply means the source will come in binary form allowing one to skip the entire CI/CD pipeline. But, there are no build strategies for <em>WAR</em> files. That’s not necessarily a bad thing given we intend to use <em>Kubernetes</em> which is a container orchestrator.</p><p>We need to get our <em>WAR</em> file in a container image. It’s a good thing <em>OpenShift</em> provides <em>Docker</em> build strategies, and since we are using a binary build, we can create the necessary environment right on our local machine and push it to a node in the cloud to build the image. In this case, the node is on our local machine. This is getting even better! In order to use the <em>Docker</em> build strategy, we need to provide that information, and the most flexible way of doing that is creating a <em>Dockerfile</em> in our current directory. The build will see the <em>Dockerfile</em> and use the <em>Docker</em> strategy.</p><pre>
FROM jetty:alpine
MAINTAINER &lt;redacted&gt;@secnix.com
ENV JAVA_OPTIONS -Xmx256m
ADD target/spring-boot-sample-war-2.0.0.RELEASE.war /var/lib/jetty/webapps/ROOT.war
EXPOSE 8080
USER jetty
ENTRYPOINT ["/docker-entrypoint.sh"]
CMD ["java","-jar","/usr/local/jetty/start.jar"]
</pre><p>This <em>Dockerfile</em> is short and very sweet. Some things to note is this simply uses the small Jetty Alpine image, assigns 256m RAM, copies the <em>WAR</em> file to the <em>webapps</em> directory as <em>ROOT.war</em> and exposes port 8080. Now we have everything in place to containerise our <em>WAR</em> file and run it in <em>Kubernetes</em> right on our personal machine – or any <em>Kubernetes</em> node.</p><p>The next step is creating the relevant objects in <em>OpenShift</em> to manage the application lifecycle. The first one is a <em>BuildConfig</em> which in turn creates an <em>ImageStream</em> to manage the image. Once this is created, the <em>BuildConfig</em> remains static, but the source – which is a binary archive from your local computer – is not reusable. Each build will need to be created by the current binaries.</p><pre>
>>> (07:22 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc new-build --binary --name=my12factorapp
* A Docker build using binary input will be created
* The resulting image will be pushed to image stream "my12factorapp:latest"
* A binary build was created, use 'start-build --from-dir' to trigger a new build
--&gt; Creating resources with label build=my12factorapp ...
imagestream "my12factorapp" created
buildconfig "my12factorapp" created
--&gt; Success</pre><p>&nbsp;</p><h3>The Final Stretch</h3><p>Now we have everything ready to create an image. We simply issue the <em>`oc start-build …`</em> command which instantiates a new build from the existing <em>BuildConfig</em> we created in the previous step. This command will archive your current local directory, transfer it to the build node, and execute the build as instructed in the <em>BuildConfig</em>. On success, the image is pushed to the registry.</p><pre>
>>> (07:44 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc start-build my12factorapp --from-dir=. --follow
Uploading directory "." as binary input for the build ...
build "my12factorapp-1" started
Receiving source from STDIN as archive ...
Step 1 : FROM jetty:alpine
---&gt; f4e374463672
Step 2 : MAINTAINER jhcook@secnix.com
---&gt; Using cache
---&gt; 02ad788c95c7
Step 3 : ENV AB_OFF true
---&gt; Using cache
---&gt; a69c85df8ee7
Step 4 : ENV JAVA_OPTIONS -Xmx256m
---&gt; Using cache
---&gt; cb48baea6c1b
Step 5 : ADD target/spring-boot-sample-war-2.0.0.RELEASE.war /var/lib/jetty/webapps/ROOT.war
---&gt; Using cache
---&gt; bc280ab639c1
Step 6 : EXPOSE 8080
---&gt; Using cache
---&gt; f39e1b10c8b6
Step 7 : USER jetty
---&gt; Using cache
---&gt; 57b3ac3023a1
Step 8 : ENTRYPOINT /docker-entrypoint.sh
---&gt; Using cache
---&gt; 397edd5de644
Step 9 : CMD java -jar /usr/local/jetty/start.jar
---&gt; Using cache
---&gt; 6a0d13d3fa80
Step 10 : ENV "OPENSHIFT_BUILD_NAME" "my12factorapp-1" "OPENSHIFT_BUILD_NAMESPACE" "myproject"
---&gt; Running in 56c8af1c0579
---&gt; ff4839efeb52
Removing intermediate container 56c8af1c0579
Step 11 : LABEL "io.openshift.build.name" "my12factorapp-1" "io.openshift.build.namespace" "myproject"
---&gt; Running in 9c23a7a0cae2
---&gt; c6c8e05ae210
Removing intermediate container 9c23a7a0cae2
Successfully built c6c8e05ae210
Pushing image 172.30.1.1:5000/myproject/my12factorapp:latest ...
Pushed 4/11 layers, 36% complete
Pushed 5/11 layers, 45% complete
Pushed 6/11 layers, 55% complete
Pushed 7/11 layers, 64% complete
Pushed 8/11 layers, 73% complete
Pushed 9/11 layers, 82% complete
Pushed 10/11 layers, 91% complete
Pushed 11/11 layers, 100% complete
Push successful</pre><p>Now we have all artifacts in place. We simply need to instruct <em>OpenShift</em> to instantiate and publish the app. There is more than one way to do this, but the easiest and most convenient method is use a <em>generator</em> such as `<em>oc</em> <em>new-app</em> <em>…`. </em>This <em>generator</em> creates a <em>DeploymentConfig</em> which in turn creates a <em>ReplicationController</em> that directs <em>pods</em> be created. Finally, it assigns <em>labels</em> and creates a <em>Service</em> which uses a <em>selector</em> to load balance traffic across pods that match the <em>labels</em>.</p><pre>
>>> (07:50 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc new-app my12factorapp
--&gt; Found image eb1c67c (About a minute old) in image stream "myproject/my12factorapp" under tag "latest" for "my12factorapp"
* This image will be deployed in deployment config "my12factorapp"
* Port 8080/tcp will be load balanced by service "my12factorapp"
* Other containers can access this service through the hostname "my12factorapp"
--&gt; Creating resources ...
deploymentconfig "my12factorapp" created
service "my12factorapp" created
--&gt; Success
Application is not exposed. You can expose services to the outside world by executing one or more of the commands below:
'oc expose svc/my12factorapp'
Run 'oc status' to view your app.</pre><p>Now pods are being created which will be load balanced by the service. Let’s access this service from our node by creating a Route which will allow traffic ingress external from the software-defined network the pods are running in.</p><pre>
>>> (07:55 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc expose svc/my12factorapp --hostname my12factorapp.192.168.99.100.nip.io
route "my12factorapp" exposed</pre><p>&nbsp;</p><h3>Finale</h3><p>You may open your browser and access the hostname! You can open your terminal and access the hostname!</p><pre>
>>> (07:57 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ curl my12factorapp.192.168.99.101.nip.io
Hello World!</pre><p>Now, you can iterate over your code, `<em>mvn -U clean package</em>`, and `<em>oc new-build …`</em> as many times it takes to get it right. When you updated image is pushed, the <em>DeploymentConfig</em> <em>triggers</em> will automatically roll out the updated image!</p><p>We will finish by looking at all the objects this project has created in <em>OpenShift</em>:</p><pre>
>>> (08:02 pm) (jcook@Justins-MacBook-Pro) (0/ttys004) (~/play/openshift/spring-boot/spring-boot-samples/spring-boot-sample-war)
$ oc get all
NAME                         TYPE      FROM      LATEST
buildconfigs/my12factorapp   Docker    Binary    1
NAME                     TYPE      FROM             STATUS     STARTED        DURATION
builds/my12factorapp-1   Docker    Binary@7b24941   Complete   1 hours ago   24s
NAME                         DOCKER REPO                               TAGS      UPDATED
imagestreams/my12factorapp   172.30.1.1:5000/myproject/my12factorapp   latest    1 hours ago
NAME                              REVISION   DESIRED   CURRENT   TRIGGERED BY
deploymentconfigs/my12factorapp   1          1         1  config,image(my12factorapp:latest)
NAME                   HOST/PORT                             PATH      SERVICES        PORT       TERMINATION   WILDCARD
routes/my12factorapp   my12factorapp.192.168.99.101.nip.io   my12factorapp   8080-tcp  None
NAME                        READY     STATUS        RESTARTS   AGE
po/my12factorapp-1-hp94v    1/1       Running       0          1h
NAME                 DESIRED   CURRENT   READY     AGErc/my12factorapp-1   0         0         0         1h
NAME                CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
svc/my12factorapp   172.30.96.16   &lt;none&gt;        8080/TCP   1h</pre><p>We sincerely hope this guide provides benefits to you on your journey to developing and deploying your app. We’re here to assist in any way we can.</p><div class='heateorFfcClear'></div><div style='width:100%;text-align:left;' class='heateor_ffc_facebook_comments'><h4 class='heateor_ffc_facebook_comments_title' style='padding:10px;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;' >Facebook Comments</h4><script type="text/javascript">!function(e,n,t){var o,c=e.getElementsByTagName(n)[0];e.getElementById(t)||(o=e.createElement(n),o.id=t,o.src="//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.2",c.parentNode.insertBefore(o,c))}(document,"script","facebook-jssdk");</script><div class="fb-comments" data-href="https://www.secnix.com/engineering-titbits/12-factor-app-in-openshift/" data-colorscheme="light" data-numposts="" data-width="100%" data-order-by="social" ></div></div><div class='heateorFfcClear'></div><div class=""> <a class="btn btn-sm btn-secondary" href="https://www.secnix.com/tag/container-native/">#container-native</a> <a class="btn btn-sm btn-secondary" href="https://www.secnix.com/tag/docker/">#docker</a> <a class="btn btn-sm btn-secondary" href="https://www.secnix.com/tag/kubernetes/">#kubernetes</a> <a class="btn btn-sm btn-secondary" href="https://www.secnix.com/tag/openshift/">#openshift</a> <a class="btn btn-sm btn-secondary" href="https://www.secnix.com/tag/spring/">#spring</a></div><hr></div><div class="col-lg-3"><div class="breadcrumb fixed-shadow"><div class="widget-content"><h3 class="widget-title">Categories</h3><ul><li class="cat-item cat-item-2"><a href="https://www.secnix.com/category/engineering-titbits/" >Engineering Titbits</a></li><li class="cat-item cat-item-3"><a href="https://www.secnix.com/category/latest-news/" >Latest News</a></li></ul></div><div class="widget-content"><h3 class="widget-title">Archives</h3><ul><li><a href='https://www.secnix.com/2019/02/'>February 2019</a></li><li><a href='https://www.secnix.com/2018/10/'>October 2018</a></li><li><a href='https://www.secnix.com/2018/04/'>April 2018</a></li><li><a href='https://www.secnix.com/2018/03/'>March 2018</a></li><li><a href='https://www.secnix.com/2018/02/'>February 2018</a></li></ul></div><div class="widget-content"><h3 class="widget-title">Recent Posts</h3><ul><li> <a href="https://www.secnix.com/engineering-titbits/build-serverless-contact-forms-for-amazon-s3-static-websites-with-aws-lambda-amazon-api-gateway-and-amazon-ses-aws-console/">Build Serverless Contact Forms for Amazon S3 Static Websites with AWS Lambda, Amazon API Gateway, and Amazon SES (AWS Console)</a> <span class="post-date">02/02/2019</span></li><li> <a href="https://www.secnix.com/engineering-titbits/distributed-containerised-infrastructure/">Distributed Containerised Infrastructure</a> <span class="post-date">16/10/2018</span></li><li> <a href="https://www.secnix.com/engineering-titbits/shared-hosting-glibc-not-found/">Shared Hosting &#8212; /lib64/libc.so.6: version GLIBC_2.14 not found</a> <span class="post-date">29/04/2018</span></li><li> <a href="https://www.secnix.com/engineering-titbits/single-page-app-angular-5-bootstrap-4-node-js/">Single Page App (Angular 5, Bootstrap 4 &#038; Node.js)</a> <span class="post-date">11/04/2018</span></li><li> <a href="https://www.secnix.com/engineering-titbits/container-native-monitoring-peeling-the-onion/">Container-native monitoring: peeling the onion</a> <span class="post-date">03/04/2018</span></li></ul></div></div></div></div></div> </section><section class="footer4 cid-qCAyS2hN15" id="footer4-p" data-rv-view="2606"><div class="container"><div class="media-container-row content mbr-white"><div class="col-lg-5 col-md-12"><div class="mb-3 img-logo"> <a href="https://secnix.com/"> <img src="https://www.secnix.com/wp-content/themes/secnixwordpress/assets/images/secnix-new.svg" alt="Secnix Systems" title="Secnix Systems" media-simple="true"> </a></div><p class="mb-4 foot-title mbr-fonts-style display-5">SECNIX SYSTEMS</p><p class="mbr-text mbr-fonts-style display-4"><a href="https://secnix.com">www.secnix.com</a></p></div><div class="col-lg-4 col-md-12"><p class="mb-4 foot-title mbr-fonts-style display-5">CONTACT</p><p class="mbr-text mbr-fonts-style display-4">Front Suite, First Floor, <br>131 High Street, <br>Teddington, <br>Middlesex, <br>England, <br>TW11 8HH<br><br>info [ @ ] secnix.com<br><a href="tel:+443338802382">+44 (0)3338 802382</a></p></div><div class="col-lg-4 offset-md-1 col-md-12"><p class="mb-4 foot-title mbr-fonts-style display-5">CONNECT</p><p class="mbr-text mbr-fonts-style display-4"> <a href="https://twitter.com/Secnix" target="_blank" alt="Secnix Systems" title="Secnix Systems"><i class="-square fa fa-3x fa-fw -square text-inverse fa-twitter"></i></a> <a href="https://github.com/secnix/" target="_blank" alt="Secnix Systems" title="Secnix Systems"><i class="-square -square fa fa-3x fa-fw fa-github text-muted"></i></a> <a href="https://instagram.com/secnix/" target="_blank" alt="Secnix Systems" title="Secnix Systems"><i class="-square -square fa fa-3x fa-fw fa fa-instagram text-success"></i></a></p><br><p class="mb-4 foot-title mbr-fonts-style display-5">LEGAL</p><p class="mbr-text mbr-fonts-style display-4"><a href="https://www.secnix.com/privacy/">Privacy Policy</a><br><a href="https://www.secnix.com/contact/">Contact Us</a></p></div></div><div class="footer-lower"><div class="media-container-row"><div class="col-sm-12"><hr></div></div><div class="media-container-row mbr-white"><div class="col-sm-12 copyright"><p class="mbr-text mbr-fonts-style display-4">Copyright © 2018 Secnix Systems Limited. All Rights Reserved. <br>Registered in England and Wales Number 07320100. VAT Number 156814004</p></div></div></div></div> </section>  <script type='text/javascript'>/*  */
var cnArgs = {"ajaxurl":"https:\/\/www.secnix.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"31536000","cookiePath":"\/","cookieDomain":"","redirection":"1","cache":"","refuse":"no","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/*  */</script> <script type='text/javascript' src='https://www.secnix.com/wp-content/uploads/fvm/out/footer-f0d41434-1547682011.min.js'></script><script type='text/javascript' src='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/smoothscroll/smooth-scroll.js'></script><script type='text/javascript' src='https://www.secnix.com/wp-content/uploads/fvm/out/footer-070e3033-1547682011.min.js'></script><script type='text/javascript' src='https://www.secnix.com/wp-content/themes/secnixwordpress/assets/recaptcha/js/scroll-fix.js'></script><script type='text/javascript' src='https://www.secnix.com/wp-content/uploads/fvm/out/footer-41f31d0f-1547682011.min.js'></script> <div id="cookie-notice" role="banner" class="cn-bottom" style="color: #a2a2a2; background-color: #000000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. If you continue to use this site we will assume that you are happy with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button">No Problem</a><a href="https://www.secnix.com/privacy/" target="_blank" id="cn-more-info" class="cn-more-info cn-button">Learn More</a></div></div><script type='text/javascript'>(function(){ var widget_id = '9b2bh41HZl';
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//code.jivosite.com/script/widget/'+widget_id+'?plugin=wp'; var ss = document.getElementsByTagName('script')[0]; ss.parentNode.insertBefore(s, ss);})();</script><script>/* loadCSS. [c]2017 Filament Group, Inc. MIT License */
(function(w){if(!w.loadCSS)w.loadCSS=function(){};var rp=loadCSS.relpreload={};rp.support=function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=false}return function(){return ret}}();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){if(link.addEventListener)link.removeEventListener("load",enableStylesheet);else if(link.attachEvent)link.detachEvent("onload",enableStylesheet);link.setAttribute("onload",null);link.media=finalMedia}if(link.addEventListener)link.addEventListener("load",enableStylesheet);else if(link.attachEvent)link.attachEvent("onload",enableStylesheet);setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3E3)};rp.poly=function(){if(rp.support())return;var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss", true);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener)w.addEventListener("load",function(){rp.poly();w.clearInterval(run)});else if(w.attachEvent)w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}if(typeof exports!=="undefined")exports.loadCSS=loadCSS;else w.loadCSS=loadCSS})(typeof global!=="undefined"?global:this);</script> <script src="https://www.google.com/recaptcha/api.js" async defer></script> <div id="scrollToTop" class="scrollToTop mbr-arrow-up"><a style="text-align: center;"><i></i></a></div> <input name="animation" type="hidden"></body></html>